\section{Detector and simulation}
\label{sec:Detector}

The \lhcb detector~\cite{Alves:2008zz,LHCb-DP-2014-002} is a single-arm forward spectrometer covering the \mbox{pseudorapidity} range $2<\eta <5$, designed for the study of particles containing \bquark or \cquark quarks. The detector includes a high-precision tracking system consisting of a silicon-strip vertex detector surrounding the $pp$ interaction region~\cite{LHCb-DP-2014-001}, a large-area silicon-strip detector located upstream of a dipole magnet with a bending power of about $4{\mathrm{\,Tm}}$, and three stations of silicon-strip detectors and straw drift tubes placed downstream of the magnet. The tracking system provides a measurement of the momentum, \ptot, of charged particles with a relative uncertainty that varies from 0.5\% at low momentum to 1.0\% at 200\gevc.  The minimum distance of a track to a primary vertex (PV), the impact parameter (IP), is measured with a resolution of $(15+29/\pt)\mum$, where \pt is the component of the momentum transverse to the beam, in\,\gevc.  The secondary vertex~(SV) resolution for three-body decays is around 20\mum in the plane transverse to the beam axis and 200\mum along the beam axis.

Different types of charged hadrons are distinguished using information from two ring-imaging Cherenkov detectors~\cite{LHCb-DP-2012-003}. Photons, electrons and hadrons are identified by a calorimeter system consisting of scintillating-pad and preshower detectors, an electromagnetic and a hadronic calorimeter. Muons are identified by a system composed of alternating layers of iron and multiwire proportional chambers~\cite{LHCb-DP-2012-002}.

The online event selection is performed by a multistage trigger\cite{LHCb-DP-2012-004}. For the analysis described here, the events are first required to pass a hardware trigger, selecting events containing at least one muon with high \pt. In the subsequent software trigger at least one muon candidate is required to have high \pt and a large impact parameter with respect to any PV. The dominant path through the last level of the trigger is a selection that requires a SV consisting of two muons with a high combined mass.

Simulated events are used to optimise the signal selection, estimate background contamination as well as calculate the relative efficiency between the signal and a normalisation channel. In the simulation, $pp$ collisions are generated using \pythia~\cite{Sjostrand:2006za,*Sjostrand:2007gs} with a specific \lhcb configuration~\cite{LHCb-PROC-2010-056}. Decays of hadronic particles are described by \evtgen~\cite{Lange:2001uf}, in which final-state radiation is generated using \photos~\cite{Golonka:2005pn}. The interaction of the generated particles with the detector, and its response, are implemented using the \geant toolkit~\cite{Allison:2006ve, *Agostinelli:2002hh} as described in Ref.~\cite{LHCb-PROC-2011-006}.

Three different models are used in the simulation for the \Bmumumu decay. The nominal model, with which efficiency for signal selection ($\varepsilon(\Bmumumu)$) is calculated, has a photon pole for one of the muon pairs and a uniform mass distribution for the combination of the third muon and the neutrino. For systematic checks, a flat phase space model is used. As a third model, the recently proposed vector-meson dominance model for the decay is used~\cite{Danilina:2018uzr}. 
